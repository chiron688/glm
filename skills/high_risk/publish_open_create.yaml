schema_version: v1
id: "publish_open_create"
name: "Publish Open Create"
version: "1.2.2"
description: "Open create/upload entry."
app:
  name: "TikTok"
risk: high
level: 2
role: flow
owner: system2
vocab_path: "skills/common/vocab.yaml"
preconditions:
  mode: best_effort
  condition:
    app_is: "TikTok"
steps:
  - id: "tap_create"
    action: Tap
    target:
      type: selector
      selector:
        text: "{{rx_create}}"
        match: regex
    retry:
      max_attempts: 2
      backoff_ms: 500
      on_codes: ["TARGET_NOT_FOUND", "ACTION_FAILED"]
    on_error:
      - name: "fallback_plus"
        trigger: on_error
        codes: ["TARGET_NOT_FOUND"]
        actions:
          - action: Tap
            target:
              type: coords
              coords: [500, 950]
              coords_type: relative
        resolution: retry
  - id: "wait_upload"
    action: Wait
    duration_ms: 800
    assert:
      condition:
        text_any_contains: "{{gallery_markers}}"
      timeout_ms: 5000
      poll_interval_ms: 500
